<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RunSmart Training Planner</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js" charset="utf-8"></script>
  </head>
  <body>
    <header class="hero">
      <nav class="nav">
        <div class="logo">RunSmart</div>
        <div class="nav-links">
          <a href="#planning">Planning</a>
          <a href="#insights">Insights</a>
          <a href="#data">Data</a>
          <a href="#roadmap">Roadmap</a>
        </div>
        <div class="nav-actions">
          <span class="user-email" id="user-email" hidden></span>
          <button class="ghost" data-action="signin" id="signin-btn">Sign in</button>
          <button class="ghost" data-action="signout" id="signout-btn" hidden>Sign out</button>
          <button class="cta" data-action="start-plan">Start Plan</button>
          <button class="menu-toggle" aria-label="Open navigation" aria-expanded="false">
            ☰
          </button>
        </div>
      </nav>
      <div class="mobile-nav" hidden>
        <a href="#planning">Planning</a>
        <a href="#insights">Insights</a>
        <a href="#data">Data</a>
        <a href="#roadmap">Roadmap</a>
      </div>
      <div class="hero-content">
        <div>
          <p class="eyebrow">AI-guided endurance training</p>
          <h1>Plan smarter, adapt faster, and train with clarity.</h1>
          <p class="subhead">
            RunSmart blends evidence-informed coaching with real-life constraints so every training block
            feels achievable, personalized, and explainable.
          </p>
          <div class="hero-actions">
            <button class="cta" data-action="generate-plan">Generate a plan</button>
            <button class="ghost" data-action="sample-week">View sample week</button>
          </div>
        </div>
        <div class="hero-card" id="hero-card">
          <div id="hero-card-static">
            <h3>Next Goal Race</h3>
            <p class="muted">Trail 50K &bull; 18 weeks out</p>
            <div class="card-grid">
              <div>
                <span class="label">Weekly focus</span>
                <strong>Base 2</strong>
              </div>
              <div>
                <span class="label">Mileage</span>
                <strong>42–48 mi</strong>
              </div>
              <div>
                <span class="label">Key workout</span>
                <strong>Progression long run</strong>
              </div>
              <div>
                <span class="label">Readiness</span>
                <strong class="positive">On track</strong>
              </div>
            </div>
            <p class="card-note">
              "You handled last week well. Keep the mid-week intensity controlled to stay fresh for the long run."
            </p>
          </div>
          <div id="hero-card-dynamic" hidden></div>
        </div>
      </div>
    </header>

    <main>
      <section id="planning" class="section">
        <div class="section-header">
          <h2>Training plan generator</h2>
          <p>
            Build goal-oriented blocks with progression guardrails, realistic scheduling, and transparent coaching
            rationale.
          </p>
        </div>
        <div class="planning-grid">
          <div class="grid">
            <article>
              <h4>Macro block builder</h4>
              <p>Base &rarr; Build &rarr; Peak &rarr; Taper sequencing tuned to your race distance and terrain.</p>
            </article>
            <article>
              <h4>Weekly structure</h4>
              <p>Long runs, intensity, and recovery days aligned to your travel and workload constraints.</p>
            </article>
            <article>
              <h4>Explainable adjustments</h4>
              <p>Every change is tied to fatigue, consistency, and execution feedback.</p>
            </article>
          </div>
          <form class="plan-form" aria-label="Generate training plan">
            <h3>Quick plan builder</h3>
            <label>
              Goal race
              <input type="text" name="race" placeholder="Trail 50K" required />
            </label>
            <label>
              Race date
              <input type="date" name="date" required />
            </label>
            <label>
              Weekly availability
              <select name="availability">
                <option value="5">5 days</option>
                <option value="6">6 days</option>
                <option value="7">7 days</option>
              </select>
            </label>
            <label>
              Current weekly mileage
              <input type="number" name="mileage" min="10" max="120" value="40" />
            </label>
            <label>
              Key constraints
              <textarea name="constraints" rows="3" placeholder="Work travel in week 6, prefer long runs on Sundays"></textarea>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="b2b" />
              Back-to-back long run weekends
            </label>
            <button class="cta" type="submit">Create draft plan</button>
            <p class="form-note" role="status" aria-live="polite"></p>
          </form>
        </div>
        <div class="my-plans" id="my-plans" hidden>
          <h3>My plans</h3>
          <div class="plans-list" id="plans-list"></div>
        </div>
        <div id="block-calendar" class="block-calendar" hidden>
          <h3>Training blocks</h3>
          <div id="block-timeline" class="block-timeline"></div>
          <div id="block-details" class="block-details"></div>
        </div>
      </section>

      <section id="insights" class="section accent">
        <div class="section-header">
          <h2>Training analysis &amp; insights</h2>
          <p>Understand readiness, spot risk early, and see the impact of your consistency.</p>
        </div>
        <div class="insight-cards">
          <div class="insight">
            <span class="pill">Training load</span>
            <h4>Acute vs chronic balance</h4>
            <p>Visualize fatigue and form trends so you can confidently push or recover.</p>
          </div>
          <div class="insight">
            <span class="pill">Performance</span>
            <h4>Race readiness forecast</h4>
            <p>Track long-run durability, vertical progression, and race-specific confidence signals.</p>
          </div>
          <div class="insight">
            <span class="pill">Risk</span>
            <h4>Overtraining alerts</h4>
            <p>Detect sudden spikes and missed recovery before they derail the block.</p>
          </div>
        </div>

        <div id="training-load-section" hidden>
          <h4>Training load trend</h4>
          <div id="training-load-chart" class="chart-container"></div>
        </div>

        <div id="long-run-section" hidden>
          <h4>Long run progression</h4>
          <div id="long-run-chart" class="chart-container"></div>
        </div>

        <div class="insight-summary" id="insight-summary">
          <div>
            <h4>Latest check-in</h4>
            <p class="muted" id="latest-checkin-text">
              No check-in yet. Submit your weekly check-in below to track readiness.
            </p>
          </div>
          <div class="stats" id="insight-stats">
            <div>
              <span class="label">Form trend</span>
              <strong id="stat-form">—</strong>
            </div>
            <div>
              <span class="label">Readiness</span>
              <strong id="stat-readiness">—</strong>
            </div>
            <div>
              <span class="label">Risk score</span>
              <strong id="stat-risk">—</strong>
            </div>
          </div>
        </div>

        <div id="checkin-section" hidden>
          <h4>Weekly check-in</h4>
          <form id="checkin-form" class="checkin-form">
            <label>
              Fatigue <output class="range-val">3</output>/5
              <input type="range" name="fatigue" min="1" max="5" value="3" />
            </label>
            <label>
              Sleep quality <output class="range-val">3</output>/5
              <input type="range" name="sleep_quality" min="1" max="5" value="3" />
            </label>
            <label>
              Motivation <output class="range-val">3</output>/5
              <input type="range" name="motivation" min="1" max="5" value="3" />
            </label>
            <label>
              Any niggles or pain?
              <input type="text" name="niggles" placeholder="e.g. left achilles tightness" />
            </label>
            <label>
              Notes
              <textarea name="notes" rows="2" placeholder="How was your week?"></textarea>
            </label>
            <button class="cta" type="submit">Submit check-in</button>
            <p class="checkin-note" role="status" aria-live="polite"></p>
          </form>
          <div id="checkin-history" class="checkin-history"></div>
        </div>
      </section>

      <section id="data" class="section">
        <div class="section-header">
          <h2>Reliable data ingestion</h2>
          <p>Sync Strava automatically, log workouts manually, and normalize everything for analytics.</p>
        </div>
        <div class="data-panel">
          <div>
            <h4>Connected sources</h4>
            <ul>
              <li>Strava activity sync</li>
              <li>Manual run + cross-training entry</li>
              <li>Heart-rate &amp; elevation support</li>
            </ul>
          </div>
          <div>
            <h4>Privacy-first storage</h4>
            <p>Supabase-backed, athlete-owned data with row-level security.</p>
            <button class="ghost" data-action="policy">Review data policy</button>
          </div>
          <div id="strava-panel">
            <h4>Strava</h4>
            <div id="strava-disconnected">
              <p class="muted">Connect your Strava account to import training data.</p>
              <button class="cta" id="strava-connect-btn">Connect Strava</button>
            </div>
            <div id="strava-connected" hidden>
              <div class="sync-list">
                <div>
                  <span class="label">Status</span>
                  <strong class="positive">Connected</strong>
                </div>
                <div>
                  <span class="label">Last sync</span>
                  <strong id="last-sync-time">Never</strong>
                </div>
              </div>
              <div class="strava-actions">
                <button class="cta" id="strava-sync-btn">Sync now</button>
                <button class="ghost" id="strava-disconnect-btn">Disconnect</button>
              </div>
            </div>
          </div>
        </div>

        <div id="weekly-dashboard" hidden>
          <h3>This week</h3>
          <div id="current-week-summary" class="week-summary-grid"></div>
          <h4>Recent weeks</h4>
          <div id="weekly-history" class="weekly-history"></div>
        </div>

        <div id="manual-entry-section" hidden>
          <h3>Log a workout</h3>
          <form id="manual-entry-form" class="manual-form">
            <label>
              Activity name
              <input type="text" name="name" placeholder="Morning trail run" required />
            </label>
            <label>
              Type
              <select name="type">
                <option value="Run">Run</option>
                <option value="Hike">Hike</option>
                <option value="Walk">Walk</option>
                <option value="Strength">Strength</option>
                <option value="Yoga">Yoga</option>
                <option value="Cross-training">Cross-training</option>
              </select>
            </label>
            <div class="form-row">
              <label>
                Distance (mi)
                <input type="number" name="distance" min="0" step="0.1" />
              </label>
              <label>
                Duration (min)
                <input type="number" name="duration" min="0" />
              </label>
              <label>
                Elevation (ft)
                <input type="number" name="elevation" min="0" />
              </label>
            </div>
            <label>
              Date
              <input type="date" name="date" required />
            </label>
            <label>
              Effort (RPE) <output class="range-val">5</output>/10
              <input type="range" name="effort" min="1" max="10" value="5" />
            </label>
            <button class="cta" type="submit">Save workout</button>
            <p class="manual-note" role="status" aria-live="polite"></p>
          </form>
        </div>

        <div id="activities-section" hidden>
          <h3>Recent activities</h3>
          <div class="activities-list" id="activities-list"></div>
        </div>
      </section>

      <section id="roadmap" class="section">
        <div class="section-header">
          <h2>Roadmap for future expansion</h2>
          <p>Designed for single-athlete focus today, ready for collaborative coaching tomorrow.</p>
        </div>
        <div class="timeline">
          <div>
            <h4>Now</h4>
            <p>Personal training optimization with explainable AI guidance.</p>
          </div>
          <div>
            <h4>Next</h4>
            <p>Coach-athlete sharing, injury prediction, and recovery integrations.</p>
          </div>
          <div>
            <h4>Later</h4>
            <p>Nutrition insights, sleep data, and smarter route intelligence.</p>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div>
        <strong>RunSmart</strong>
        <p>Evidence-informed training guidance for endurance runners.</p>
      </div>
      <div class="footer-links">
        <span>Support</span>
        <span>Privacy</span>
        <span>Contact</span>
      </div>
    </footer>

    <div class="modal-overlay" id="auth-modal" hidden>
      <div class="modal">
        <button class="modal-close" aria-label="Close">&times;</button>
        <div class="modal-tabs">
          <button class="modal-tab active" data-tab="signin">Sign in</button>
          <button class="modal-tab" data-tab="signup">Sign up</button>
        </div>
        <form class="auth-form" id="auth-form">
          <label>
            Email
            <input type="email" name="email" required />
          </label>
          <label>
            Password
            <input type="password" name="password" minlength="6" required />
          </label>
          <button class="cta" type="submit">Sign in</button>
          <p class="auth-error" role="alert" aria-live="polite"></p>
        </form>
      </div>
    </div>

    <script src="config.js"></script>
    <script src="app.js"></script>
  </body>
</html>
